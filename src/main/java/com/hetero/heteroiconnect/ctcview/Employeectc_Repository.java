package com.hetero.heteroiconnect.ctcview;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.sql.DataSource;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;

import net.sf.json.JSONArray;
import net.sf.json.JSONObject;


@Repository

public class Employeectc_Repository {


	@Autowired
	JdbcTemplate jdbcTemplate;
	
	@Autowired
	private DataSource dataSource;
	
	@PersistenceContext
	EntityManager entityManager;

	   
       public void setDataSource(DataSource dataSource) {
           this.jdbcTemplate = new JdbcTemplate(dataSource);
       }
       
       public synchronized JSONArray ctcview(String Employeeid,String Password,String HRMSEMPLOYEEID) throws SQLException
   	{ 
   				Connection conn = dataSource.getConnection();
   				JSONArray empJson_arr= new JSONArray();
   				java.sql.PreparedStatement Stmt=null;
   	//			String CTCQuery="SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS',co.NAME 'COSTCENTER', GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee',  IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO',  IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO,  IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE,  IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE',  IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE',  IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2,  IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4,  IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP,  IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2,  IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4,  IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE,  IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO',  IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN',  IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details',  IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp',  CTC.EFFECTIVEDATE,IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS',  IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC',  IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA',  IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA',  IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL',  IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION',  IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPLALLOW',  IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVELALLOWANCE',  IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KITALLOWANCE',  IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA',  IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS',  IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0') 'EGross',  IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT',  IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF',  IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0') 'TotalDeduction', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTAANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PFANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESIANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUSANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITYANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0') 'ANNUABONUSANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICALPREMIUMANNUALBENIFITS',  IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE',  IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS',  IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE',  IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET',  IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT',  IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') 'TotalAnnualBenefits' ,IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') CTC,ROUND((IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0'))/12,0) CTCPERMONTH FROM  HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A 	  LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON 	A.STATUS=STATUS.STATUS  LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU 	ON A.COMPANYID=BU.BUSINESSUNITID  LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D 	ON A.EMPLOYEEID=D.EMPLOYEEID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC 	ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID  LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID  LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID  LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID  LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID  LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID  LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID  LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID  LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID  LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID  LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID  LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid,max(EFFECTIVEDATE) EFFECTIVEDATE FROM  HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID  LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid  LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID  LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID  LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS   GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID   LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from   hclhrm_prod.tbl_employee_assets where assetid=16 and status=1001 group by employeeid )IMPRS ON   IMPRS.employeeid=A.employeeid   LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM   hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID   LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM   HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID   LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM   hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID   LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID   LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID   LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER   LEFT JOIN hcladm_prod.tbl_costcenter co on co.COSTCENTERID=a.COSTCENTERID WHERE A.EMPLOYEESEQUENCENO in('"+Employeeid+"')    group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO";
   	
   				
   				
   				
   				//String ESICHECK="SELECT 'ESI',COMPONENTVALUE FROM tbl_employee_latest_ctc_details where componentid=32 and UPDATEDPAYPERIOD IN (SELECT MAX(UPDATEDPAYPERIOD) FROM tbl_employee_latest_ctc_details where employeeid="+HRMSEMPLOYEEID+") and employeeid="+HRMSEMPLOYEEID+" ";
   				
   				String ESICHECK="SELECT IFNULL(MAX(IF(COMPONENTID=32,COMPONENTVALUE,0)),0) ESIVALUE,IFNULL(MAX(IF(COMPONENTID=35,COMPONENTVALUE,0)),0) ANNUALESI FROM tbl_employee_latest_ctc_details where componentid in(32,35) and UPDATEDPAYPERIOD IN (SELECT MAX(UPDATEDPAYPERIOD) FROM tbl_employee_latest_ctc_details where employeeid='"+HRMSEMPLOYEEID+"') and employeeid='"+HRMSEMPLOYEEID+"' GROUP BY EMPLOYEEID";
   				  
   				
   				String CTCQuery="SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS',co.NAME 'COSTCENTER', GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee',  IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO',  IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO,  IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE,  IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE',  IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE',  IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2,  IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4,  IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP,  IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2,  IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4,  IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE,  IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO',  IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN',  IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details',  IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp',  CTC.EFFECTIVEDATE, IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS',  IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC',  IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA',  IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA',  IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL',  IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION',  IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPLALLOW',  IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVELALLOWANCE',  IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KITALLOWANCE',  IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA',  IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS', IFNULL(MAX(IF(CTCD.COMPONENTID=124,CTCD.COMPONENTVALUE,0)),'0') 'OtherALLOWANCE',   IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=124,CTCD.COMPONENTVALUE,0)),'0') 'EGross',  IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT',  IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF',  IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0') 'TotalDeduction', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTAANNUALBENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PFANNUALBENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESIANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUSANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITYANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0') 'ANNUABONUSANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICALPREMIUMANNUALBENIFITS',  IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE',  IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS',  IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE',  IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET',  IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT',  IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY',IFNULL(MAX(IF(CTCD.COMPONENTID=129,CTCD.COMPONENTVALUE,0)),'0') 'VARIABLEPAY', IFNULL(MAX(IF(CTCD.COMPONENTID=130,CTCD.COMPONENTVALUE,0)),'0') 'PerformanceLinkedBonus', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=63,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=129,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=130,CTCD.COMPONENTVALUE,0)),'0') 'TotalAnnualBenefits' , IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=124 THEN CTCD.COMPONENTVALUE*12 END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=129,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=130,CTCD.COMPONENTVALUE,0)),'0') CTC, ROUND(((IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=124,CTCD.COMPONENTVALUE,0)),'0'))*12+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=129,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=130,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=63,CTCD.COMPONENTVALUE,0)),'0'))/12,0) CTCPERMONTH FROM  HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A 	  LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON 	A.STATUS=STATUS.STATUS  LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU 	ON A.COMPANYID=BU.BUSINESSUNITID  LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D 	ON A.EMPLOYEEID=D.EMPLOYEEID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC 	ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID  LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID  LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID  LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID  LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID  LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID  LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID  LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID  LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID  LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID  LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID  LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid,max(EFFECTIVEDATE) EFFECTIVEDATE FROM  HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID  LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid  LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID  LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID  LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS   GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID   LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from   hclhrm_prod.tbl_employee_assets where assetid=16 and status=1001 group by employeeid )IMPRS ON   IMPRS.employeeid=A.employeeid   LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM   hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID   LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM   HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID   LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM   hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID   LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID   LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID   LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER   LEFT JOIN  hcladm_prod.tbl_costcenter co on co.COSTCENTERID=a.COSTCENTERID  LEFT JOIN hclhrm_prod.tbl_employee_login login on login.employeecode=A.EMPLOYEESEQUENCENO WHERE A.EMPLOYEESEQUENCENO in('"+Employeeid+"') and login.password=MD5('"+Password+"') group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO";
   				
   	//			String CTCQuery="SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS',co.NAME 'COSTCENTER', GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee',  IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO',  IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO,  IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE,  IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE',  IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE',  IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2,  IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4,  IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP,  IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2,  IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4,  IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE,  IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO',  IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN',  IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details',  IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp',  CTC.EFFECTIVEDATE, IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS',  IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC',  IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA',  IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA',  IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL',  IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION',  IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPLALLOW',  IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVELALLOWANCE',  IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KITALLOWANCE',  IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA',  IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS', IFNULL(MAX(IF(CTCD.COMPONENTID=124,CTCD.COMPONENTVALUE,0)),'0') 'OtherALLOWANCE',   IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=124,CTCD.COMPONENTVALUE,0)),'0') 'EGross',  IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT',  IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF',  IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0') 'TotalDeduction', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTAANNUALBENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PFANNUALBENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESIANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUSANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITYANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0') 'ANNUABONUSANNUALBENIFITS',  IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICALPREMIUMANNUALBENIFITS',  IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE',  IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS',  IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE',  IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET',  IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT',  IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY', IFNULL(MAX(IF(xx.COMPONENTID=9007,xy.COMPONENTVALUE,0)),'0') 'VARIABLEPAY', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') 'TotalAnnualBenefits' , IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=124 THEN CTCD.COMPONENTVALUE*12 END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(xx.COMPONENTID=9007,xy.COMPONENTVALUE,0)),'0') CTC, ROUND(((IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')+  IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(CTCD.COMPONENTID=124,CTCD.COMPONENTVALUE,0)),'0'))*12+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+   IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')+IFNULL(MAX(IF(xx.COMPONENTID=9007,xy.COMPONENTVALUE,0)),'0'))/12,0) CTCPERMONTH FROM  HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A 	  LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON 	A.STATUS=STATUS.STATUS  LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU 	ON A.COMPANYID=BU.BUSINESSUNITID  LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D 	ON A.EMPLOYEEID=D.EMPLOYEEID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC 	ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID  LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID  LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID  LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID  LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID  LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID  LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID  LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID  LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID  LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID  LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID  LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID  LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid,max(EFFECTIVEDATE) EFFECTIVEDATE FROM  HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID  LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid  LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID  LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID  LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS   GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID   LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from   hclhrm_prod.tbl_employee_assets where assetid=16 and status=1001 group by employeeid )IMPRS ON   IMPRS.employeeid=A.employeeid   LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM   hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID   LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM   HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID   LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM   hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID   LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID   LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID   LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER   LEFT JOIN  hcladm_prod.tbl_costcenter co on co.COSTCENTERID=a.COSTCENTERID  LEFT JOIN hclhrm_prod.tbl_employee_login login on login.employeecode=A.EMPLOYEESEQUENCENO WHERE A.EMPLOYEESEQUENCENO in('30301')  group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO";
   				
   				
   				ResultSet rs =null;
try
{
	         double ESIVALUE=0.0;
	         double AnnualESI=0.0;
	         
	         boolean Newjoin_FLAG=false;
	         
	         double RemoveAnnualESI=0.0;
	         
	   
	         List<Object[]> ESICHECK_Obj = entityManager.createNativeQuery(ESICHECK).getResultList();
	         for (Object temp[] : ESICHECK_Obj) {
	        	 //temp[0].toString() temp[1].toString()
	        	 ESIVALUE= Double.parseDouble(temp[0].toString());
	        	 AnnualESI=Double.parseDouble(temp[1].toString());
	        	 System.out.println(ESIVALUE+"HI");
	        	 
	        	 Newjoin_FLAG=true;
	         } 
	               
	
   			Stmt = conn.prepareStatement(CTCQuery.toString());
			rs = Stmt.executeQuery();
			ResultSetMetaData metadata = rs.getMetaData();
		    int columnCount = metadata.getColumnCount();    
		    while (rs.next()) {
		    	JSONObject obj=new JSONObject();
		        for (int i = 1; i <= columnCount; i++) {
		        
		        	
		        	 if(metadata.getColumnLabel(i).equalsIgnoreCase("ESI"))
		            {
		        		 System.out.println(ESIVALUE+"<-------->"+rs.getString(i));
		        		  
		            	 if(ESIVALUE==0.00&&Newjoin_FLAG)
				            {
				            	 obj.put("ESI", "0");
				            	 
				            	 
				            }
		            	 else 
				            {
				            	obj.put(metadata.getColumnLabel(i), rs.getString(i));
				            
				            }
		            }
		        	 
		        else if(metadata.getColumnLabel(i).equalsIgnoreCase("ESIANNUALBENIFITS"))
		            {
		            	 if(ESIVALUE==0.00&&Newjoin_FLAG)
				            {
				            	 obj.put("ESIANNUALBENIFITS", "0");
				            	 
				            	// AnnualESI=rs.getString(i);
				            	 RemoveAnnualESI=rs.getInt(i);
				            	 
				            }
		            	 else 
				            {
				            	obj.put(metadata.getColumnLabel(i), rs.getString(i));
				            	 
				            }
		  
		            }
		        	 
		        	 ///for change 
		        	 
		        else if(metadata.getColumnLabel(i).equalsIgnoreCase("TotalAnnualBenefits"))
	            {
	            	 if(ESIVALUE==0.00&&Newjoin_FLAG)
			            {
			            	// obj.put("ESIANNUALBENIFITS", "0");
	            		 
	            		    int TotalAnnualBenefits=0;
	            		    TotalAnnualBenefits= rs.getInt(i)-(int)RemoveAnnualESI;
			            	
	            		    System.out.println(AnnualESI+"TotalAnnualBenefits");
	            		    obj.put(metadata.getColumnLabel(i),TotalAnnualBenefits);
			            }
	            	 else 
			            {
	            		    
			            	obj.put(metadata.getColumnLabel(i), rs.getString(i));
			            }
	  
	            }
		        	 
		        else if(metadata.getColumnLabel(i).equalsIgnoreCase("CTC"))
	            {
	            	 if(ESIVALUE==0.00&&Newjoin_FLAG)
			            {
	            		    int CTC=0;
	            		    CTC=rs.getInt(i)-(int)RemoveAnnualESI;
	            		    obj.put(metadata.getColumnLabel(i),CTC);
			            }
	            	 else 
			            {
			            	obj.put(metadata.getColumnLabel(i), rs.getString(i));
			            	 
			            }
	  
	            }
		        	 
		        else if(metadata.getColumnLabel(i).equalsIgnoreCase("CTCPERMONTH"))
	            {
	            	 if(ESIVALUE==0.00&&Newjoin_FLAG)
			            {
	            		    int CTCPERMONTH=0;
	            		    CTCPERMONTH=rs.getInt(i)-(int)RemoveAnnualESI/12;
	            		    obj.put(metadata.getColumnLabel(i),CTCPERMONTH);
			            }
	            	 else 
			            {
			            	obj.put(metadata.getColumnLabel(i), rs.getString(i));
			            	 
			            }
	  
	            }
		            else 
		            {
		            	obj.put(metadata.getColumnLabel(i), rs.getString(i));
		            }
		           
		        	
		            //obj.remove("ESI");
		        }
		        empJson_arr.add(obj);
		    }
		    
   								
   			 }catch(Exception ex){
   						  ex.printStackTrace();
   					  }
   					  finally {
   							try {
   								rs.close();
   								Stmt.close();
   								conn.close();
   							}catch(Exception ex) {
   								ex.printStackTrace();
   							}
   							
   						}
   					  jdbcTemplate.getDataSource().getConnection().close();
   					  
   					  return empJson_arr;
   				 

   		}
}
